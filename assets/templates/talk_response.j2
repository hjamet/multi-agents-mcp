<global_context>
{{ context }}
</global_context>

<role_reminder>
You are **{{ name }}**.
{{ role_snippet }}
</role_reminder>

<conversation_history>
{{ conversation_history }}
</conversation_history>

<memory>
{{ memory_content }}
</memory>

{% if search_results_markdown %}
<relevant_context>
{{ search_results_markdown }}
</relevant_context>
{% endif %}

<instructions>
**{{ language_instruction }}**

{% if instruction %}
<instruction>
{{ instruction }}
</instruction>
{% endif %}

{% if notification %}
<notification>
**{{ notification }}**
</notification>
{% endif %}

{% if replied_to_message %}
<replied_to>
{{ replied_to_message }}
</replied_to>
{% endif %}

{% if backlog_instruction %}
<backlog_reminder>
**{{ backlog_instruction }}**
</backlog_reminder>
{% endif %}

It is your turn to speak.
1. **Analyze** the LATEST messages above.
2. **Decide** who to speak to next based on your Connections table below.
3. **Call `talk(...)`** to send your message and pass the turn.

**Arguments for `talk`:**
- `message`: Your content.
- `from_agent`: YOUR IDENTITY (must match your registered name).
- `private`: If true, ONLY mentioned agents see the message. If false (default), everyone sees it.
</instructions>

<connections>
**Communication Guide (Tool 'talk'):**
- `message`: Your content.
- `from_agent`: YOUR IDENTITY (must match your registered name).
- `private`: If true, ONLY mentioned agents see the message. If false (default), everyone sees it.

{% if is_open_mode %}
| Authorized | Agent Name | Notes / Context |
| :---: | :--- | :--- |
{% for a in agent_directory %}
| {% if a.authorized %}[x]{% else %}[ ]{% endif %} | **{{ a.name }}** | {{ a.public_desc }} {{ a.note }} |
{% endfor %}
{% else %}
| Agent Name | Notes / Context |
| :--- | :--- |
{% for a in agent_directory %}
| **{{ a.name }}** | {{ a.public_desc }} {{ a.note }} |
{% endfor %}
{% endif %}
</connections>
